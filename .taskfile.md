# Taskfile クイックリファレンス

このプロジェクトでは [Task](https://taskfile.dev) を使用してビルド・開発タスクを管理しています。

## セットアップ

### Task のインストール

```powershell
# winget（推奨）
winget install Task.Task

# Scoop
scoop install task

# Chocolatey
choco install go-task

# または公式サイトから: https://taskfile.dev/installation/
```

### 依存関係のインストール

```bash
task install
```

## 主要コマンド

### ビルド

```bash
# 完全ビルド（フロントエンド + バックエンド + パッケージング）
task build

# フロントエンドのみビルド
task build:frontend

# バックエンドのみビルド（PyInstaller）
task build:backend
```

### 開発

```bash
# フロントエンド開発サーバー起動
task dev:frontend

# バックエンド開発サーバー起動
task dev:backend
```

### 品質チェック

```bash
# 全チェック実行（フォーマット・lint・型チェック・テスト）
task verify

# Lint
task lint                    # 全体
task lint:backend            # バックエンドのみ
task lint:frontend           # フロントエンドのみ
task lint:backend:fix        # バックエンド自動修正
task lint:frontend:fix       # フロントエンド自動修正

# フォーマット
task format                  # 全体（実行）
task format:check            # 全体（チェックのみ）
task format:backend          # バックエンド
task format:frontend         # フロントエンド

# 型チェック
task type-check              # 全体
task type-check:backend      # バックエンドのみ
task type-check:frontend     # フロントエンドのみ

# テスト
task test                    # 全テスト
task test:verbose            # 詳細出力
```

### クリーンアップ

```bash
# 全ビルド成果物を削除
task clean

# dist/build のみ削除
task clean:dist

# frontend/dist と node_modules を削除
task clean:frontend
```

### その他

```bash
# ビルドした実行ファイルを起動
task run

# 利用可能なタスク一覧を表示
task --list
# または
task help
```

## Tips

### タスクの詳細を確認

```bash
task --summary <タスク名>
```

### タスクの実行内容を確認（dry-run）

```bash
task --dry <タスク名>
```

### 並列実行

```bash
# 複数のタスクを同時実行
task lint:backend lint:frontend
```

## 従来のスクリプトとの対応

| 従来                            | Task                  |
| ------------------------------- | --------------------- |
| `scripts/build_webview.ps1`     | `task build`          |
| `cd frontend && npm run dev`    | `task dev:frontend`   |
| `uv run uvicorn ...`            | `task dev:backend`    |
| `uv run ruff format .`          | `task format:backend` |
| `cd frontend && npm run verify` | `task verify`         |

## トラブルシューティング

### Task が見つからない

PowerShell の場合、パスが通っているか確認：

```powershell
Get-Command task
```

### 並列開発サーバー起動

現在 `task dev` は単一コマンドでの並列起動に対応していません。  
2 つのターミナルを開いて、それぞれ以下を実行してください：

```bash
# ターミナル1
task dev:frontend

# ターミナル2
task dev:backend
```

将来的には tmux/wezterm/windows ターミナル連携での並列起動に対応予定。
